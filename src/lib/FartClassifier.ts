
import { ILog } from './ILog';
import * as convnetjs from 'convnetjs';
// declare var convnetjs: any;

export class FartClassifier {

    private log: ILog = { info() {}, debug() {}, error() {}};
    private net: any;
    private targets: number[][] = [];
    private targetRanges: number[][] = [];
    private trainer: any;


    constructor(opts) {
        this.init(opts);
    }

    public classify(input) {
        if (input.length !== 3) { throw Error('input not length of 3'); }
        const vol = new convnetjs.Vol(input);

        const prediction = this.net.forward(vol).w[0];
        let targ = this.targets[0];

        for (let t = 0; t < this.targets.length; t++) {
            const temp = this.targets[t];
            const range = this.targetRanges[t];
            if (prediction > range[0] &&  prediction < range[1]) {
                targ = temp;
                break;
            }
        }
        this.log.info('FartClassifier.classify  fixed out: ' + targ + ' out: ' + prediction + '  in: ' + input);
        return targ;
    }

    public getNetConfig() {
        return {layers: [{out_depth: 3, out_sx: 1, out_sy: 1, layer_type: 'input'}, {out_depth: 20, out_sx: 1, out_sy: 1, layer_type: 'fc', num_inputs: 3, l1_decay_mul: 0, l2_decay_mul: 1, filters: [{sx: 1, sy: 1, depth: 3, w: {0: 0.3463688952709865, 1: 0.02345214232049256, 2: 0.043247484568984536}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.10097528709079297, 1: -0.07301908035351375, 2: -0.04255694796077457}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.00775834759376996, 1: 0.002955511355613097, 2: 0.1009558675794845}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.0751356304378796, 1: -0.0319039639606984, 2: -0.3101217568769659}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.020028606624299644, 1: 0.12370555448374464, 2: -0.6157719919740612}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.06557335460191267, 1: -0.34525910114919844, 2: -0.4132008979057677}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.11236134039608023, 1: -0.6269300111187077, 2: 0.1511460732756949}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.526233702409536, 1: -0.09561213688991124, 2: -0.110760973270005}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.06549410228053461, 1: 0.07266449951375406, 2: 0.057880370222799425}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.07844770482938719, 1: 0.07529316944033597, 2: 0.05926016681310635}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.02134774659660031, 1: -0.013432699728772842, 2: 0.10483238958473678}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.018880192356315235, 1: 0.41230391435363906, 2: -0.016028621746934698}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.081727642647148, 1: -0.07858079544937649, 2: -0.09128403269539981}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.3409061587986573, 1: 0.01928083539428805, 2: 0.043313175481067744}}, {sx: 1, sy: 1, depth: 3, w: {0: 0.07816443288207922, 1: 0.06811956759549434, 2: 0.07381224183326182}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.1083705643010572, 1: -0.12192985875679768, 2: 0.6502387409593358}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.030948458743174385, 1: -0.024913605097034424, 2: 0.11406636128331578}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.06438375678911934, 1: -0.06550615273766887, 2: -0.06368720137192667}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.09200209158022271, 1: -0.0912651179778145, 2: -0.0776323114102447}}, {sx: 1, sy: 1, depth: 3, w: {0: -0.08528242280691557, 1: -0.0794512469043289, 2: -0.06918771967645322}}], biases: {sx: 1, sy: 1, depth: 20, w: {0: -0.09240214638040525, 1: 0.04668608069823667, 2: -0.05428765440905301, 3: 0.0502798304376057, 4: 0.11669475049479137, 5: -0.09721118599652104, 6: -0.037273869080138446, 7: -0.002118082381951239, 8: -0.0035422252965675314, 9: -0.06490040829687999, 10: -0.06784943428473612, 11: -0.20189684270142522, 12: 0.12632836435875777, 13: -0.044353429068584534, 14: -0.08903471758381279, 15: -0.09602193971665184, 16: -0.1382232146286861, 17: -0.014501149745245539, 18: 0.1174375005939746, 19: 0.05167290392791817}}}, {out_depth: 20, out_sx: 1, out_sy: 1, layer_type: 'sigmoid'}, {out_depth: 30, out_sx: 1, out_sy: 1, layer_type: 'fc', num_inputs: 20, l1_decay_mul: 0, l2_decay_mul: 1, filters: [{sx: 1, sy: 1, depth: 20, w: {0: 0.06970732518608305, 1: 0.005555272599538312, 2: -0.009036852569920303, 3: -0.04923982957430624, 4: -0.16300704524560594, 5: -0.09090598291601694, 6: -0.17504712998954028, 7: 0.10984155164314229, 8: 0.008925382198712304, 9: 0.009241164854893149, 10: -0.011517432282396782, 11: 0.09222917148146745, 12: 0.012166992996931858, 13: 0.07091222939066986, 14: 0.003011448277934709, 15: 0.18048394633533302, 16: -0.019675800810703137, 17: -0.004444729118005366, 18: 0.011620521505526147, 19: -0.005982803596280358}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.006236570804098097, 1: -0.008402014101899984, 2: -0.005005616975154712, 3: -0.0026864330095462707, 4: -0.004672806391507135, 5: -0.005719085851859264, 6: -0.004633812137252269, 7: -0.006495190213868231, 8: -0.008666268545635038, 9: -0.002206195444855077, 10: 0.00046136371742705863, 11: -0.0018869636124675333, 12: 0.001177733673304194, 13: -0.0016407692853346227, 14: -0.002466416832739858, 15: -0.0023760500629291287, 16: -0.003486694203057608, 17: -0.008870328942824317, 18: -0.0005529764594862226, 19: -0.003600661850288458}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.1010702352222869, 1: 0.007327322858087606, 2: 0.007891016973145478, 3: 0.14207831418281494, 4: 0.32461007648485424, 5: 0.1595953440045819, 6: 0.3528820089419712, 7: -0.11537024637873787, 8: -0.013949773473850232, 9: -0.019507277298220747, 10: 0.019874218339361593, 11: -0.16673788075840326, 12: 0.053904308239541, 13: -0.10818850670139524, 14: -0.02481028824151598, 15: -0.2881094462281765, 16: 0.022828411677626854, 17: 0.050339216667557515, 18: 0.05238223454302132, 19: 0.04549162426770335}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.007162394471558682, 1: -0.0041561311492171365, 2: -0.004419028752751834, 3: -0.004121289748804656, 4: -0.00394203092453714, 5: 0.004173460729993736, 6: -0.001655613554035566, 7: -0.0045725577027582965, 8: -0.006005523734096346, 9: -0.005612981313833295, 10: -0.003247501400238867, 11: -0.001953117637934913, 12: -0.0012483193909783408, 13: -0.0013137431909873267, 14: -0.0034230346843849967, 15: -0.006513995041551506, 16: -0.0015189568499045028, 17: 0.0016006784220211324, 18: -0.0022924092351692947, 19: 0.001404345955259565}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.02700243322161619, 1: 0.006339247365739107, 2: -0.0020418316801504763, 3: 0.0002746116705001554, 4: -0.007011079531653037, 5: -0.0037244968939663583, 6: 0.031018153871168585, 7: -0.03447269121665343, 8: -0.013072580194896986, 9: -0.02697693116639813, 10: -0.0032102497267942707, 11: -0.031948687849942356, 12: -0.00454894944835733, 13: -0.014582288184634784, 14: -0.010770383422869604, 15: 0.0035270240612225306, 16: -0.0035353851892337335, 17: -0.0005267165169889116, 18: 0.01147681850731995, 19: 0.004912835282282986}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0031079482206033057, 1: 0.0028607285646204874, 2: 0.0006224586830304382, 3: 0.001261168891460789, 4: 0.00021358444010750765, 5: -0.0002737820839503656, 6: 0.00017101610370212367, 7: -0.000686165972277242, 8: -0.006104718200261682, 9: -0.005129589806923389, 10: 0.0005064098252060253, 11: -0.008237922622678001, 12: 0.0001565085258129472, 13: -0.007051727786018402, 14: -0.004714497290892688, 15: -0.0044631869779490916, 16: -0.0034013473571580547, 17: -0.0010279487961810244, 18: -0.005244447187199697, 19: -0.0009917819148576718}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.027460651722698428, 1: 0.03281656427705912, 2: -0.003083392202040495, 3: -0.00644619656048133, 4: -0.13549182218791903, 5: -0.03704839127735559, 6: -0.08794234055256622, 7: 0.06101914192276997, 8: -0.028970785830192376, 9: -0.029894826594524727, 10: -0.0022187981168828386, 11: 0.02219246688957617, 12: 0.0309766580618318, 13: 0.0279820340955891, 14: -0.03307988927353949, 15: 0.13991431905131702, 16: 0.0032996130630514914, 17: 0.005042343091540703, 18: 0.04193864680184942, 19: 0.030458576104086955}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.01754411642647645, 1: 0.007780863033368363, 2: -0.005272670338671209, 3: 0.0080837126615701, 4: 0.009598035018930964, 5: 0.018309062894944206, 6: 0.017380148206626856, 7: -0.018780609764919336, 8: -0.016368250968234858, 9: -0.018938735925356998, 10: -0.0033396793729091544, 11: -0.02020213679984345, 12: 0.0042325962665981124, 13: -0.01516392230311336, 14: -0.01323854625825149, 15: -0.013916321655445088, 16: -0.008632683317908485, 17: -0.00039920988697771424, 18: 0.0035241939479830698, 19: 0.0026416698119344217}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.03527325545274732, 1: 0.00536677795499729, 2: -0.004804175547053009, 3: -0.021505568819635897, 4: -0.06696687107826563, 5: -0.042071501136795454, 6: -0.07885461117118818, 7: 0.04570852870913223, 8: 0.0005885102998620259, 9: 0.0036352865857181894, 10: -0.003474013284878259, 11: 0.04339141458942924, 12: 0.0067865215482224035, 13: 0.02712644394572464, 14: 0.0004006179019203017, 15: 0.07765368978053908, 16: -0.01008585463363092, 17: 0.001761658070102537, 18: 0.005616674799201719, 19: -0.0003356231740547768}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.2054871426410201, 1: 0.16145933945506605, 2: 0.013605285125617076, 3: 0.2093737785635841, 4: 0.22800084082182104, 5: 0.26242434055876057, 6: 0.28912520364931005, 7: -0.2656016455491016, 8: -0.0844758793234034, 9: -0.10782598972053409, 10: 0.03274377041563683, 11: -0.19171546420093577, 12: 0.16957172678208374, 13: -0.19729572417518135, 14: -0.1173837193333903, 15: -0.14076099844505166, 16: 0.0466187634919778, 17: 0.12697041497494474, 18: 0.20070618267164847, 19: 0.17653520469498046}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.008612534376098949, 1: -0.006098700800249506, 2: -0.00547472548357008, 3: -0.006832211398674943, 4: -0.008716822781431339, 5: 0.006909838261398371, 6: -0.0034317712420918697, 7: -0.002848701684171078, 8: -0.011475525938129604, 9: -0.0027712664494895234, 10: -0.006713846312771196, 11: -0.0031437444273884688, 12: -0.0035292605557312724, 13: -0.008901524725610873, 14: -0.00347274329942025, 15: -0.004709884430932312, 16: -0.0050850808160120865, 17: 0.001712934302411818, 18: -0.000298423995011573, 19: -0.0025222979615879223}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0010452171477539362, 1: -0.005081785146270564, 2: -0.005151813564645886, 3: -0.00045449358349269734, 4: -0.005022384547245309, 5: -0.006357610152633995, 6: -0.004609541916072809, 7: -0.0008208891671505311, 8: -0.0015966128753456608, 9: -0.005756765369782335, 10: -0.0027830606353313613, 11: -0.005308010013253541, 12: -0.0029383048778617877, 13: 0.0038279608767271107, 14: -0.0053075304623238775, 15: -0.005381118638423839, 16: -0.007478171861707016, 17: -0.004219577487385779, 18: -0.005633085985921067, 19: -0.00016175853295692812}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0033071031865537985, 1: 0.0006489810217802182, 2: 0.0008487401228435155, 3: -0.005012623354890696, 4: -0.0005384817362530886, 5: -0.0001597906364137302, 6: 0.0007768374872954291, 7: -0.0034854242026217033, 8: -0.00019575021465225516, 9: -0.0036453240838471676, 10: -0.0003570424548171556, 11: -0.0025669149116614447, 12: -0.0011921126463892092, 13: -0.005909741949407805, 14: -0.004325114117245012, 15: -0.004603969272171648, 16: -0.0020389292983756134, 17: 0.0013042092865432901, 18: -0.0015385122175301854, 19: 0.002120766969220797}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.034853743603532494, 1: 0.0006741478420080896, 2: -0.004801590806860772, 3: -0.021999641537481615, 4: -0.07360622980179747, 5: -0.04414413727478804, 6: -0.08457828628584212, 7: 0.04715013876567608, 8: 0.005988884935552089, 9: 0.0029464589440094963, 10: -0.010447995844031742, 11: 0.04847401795392903, 12: 0.009642839849906585, 13: 0.031806254467315644, 14: 0.004079181400794402, 15: 0.08273396128259271, 16: -0.008625950061323709, 17: -0.0026186746203936064, 18: -0.0016859905245474938, 19: -0.002438888985575455}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.10460154848020314, 1: 0.009280422986287807, 2: -0.024539043030809216, 3: -0.07086513655926975, 4: -0.2519131073812048, 5: -0.15276380675301066, 6: -0.27954990669106466, 7: 0.15618689353968582, 8: -0.0006829499361064203, 9: 0.0015166744670830248, 10: -0.026003682198490523, 11: 0.14120422121228526, 12: 0.026587354354609113, 13: 0.10042274191950513, 14: 0.006241198540855704, 15: 0.27239346496675343, 16: -0.026955444860470728, 17: -0.016101452204206623, 18: 0.01267058233322221, 19: -0.010166382194317885}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.0009174912360607974, 1: -0.0016048446154315846, 2: -0.000680555862084471, 3: -0.003630827428025871, 4: -0.0018271305146889147, 5: -0.0014969931070789493, 6: -0.00030739973080344616, 7: 0.0026322948113432732, 8: -0.0019351675986690902, 9: 0.00012366319043292362, 10: 0.002187316133079322, 11: -0.002568580441073803, 12: -0.0018949030050454086, 13: 0.0016829234938336903, 14: -0.001347470853183179, 15: -0.0030234066046925813, 16: -0.003237097373018492, 17: -0.0017939659122807317, 18: -0.0005328142399324491, 19: 0.0016205040445319157}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.036395988452821236, 1: -0.0010258269399483412, 2: -0.004993400716426169, 3: -0.024529881966660255, 4: -0.0801291077528861, 5: -0.04685385769933418, 6: -0.0879817084741116, 7: 0.05545929824449232, 8: 0.002725752710349793, 9: 0.007024867311540232, 10: -0.007111726982229549, 11: 0.04705928405869974, 12: 0.007444877006763837, 13: 0.03704098803149061, 14: 0.0035196610504321458, 15: 0.09054828068583039, 16: -0.006636853207047684, 17: -0.00500875519278235, 18: 0.000036639400837960256, 19: -0.0009057809411574997}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.015297105972444356, 1: 0.004387492043929902, 2: -0.0027217455914104773, 3: 0.0089723181065789, 4: 0.006014803543499259, 5: 0.011792457493577338, 6: 0.015878087301966912, 7: -0.01749059703868629, 8: -0.01198765423775489, 9: -0.017270870864348205, 10: -0.006417331759478552, 11: -0.021108693753388124, 12: 0.0035859625523024237, 13: -0.015546788517742499, 14: -0.016931950850302507, 15: -0.017413738673690272, 16: -0.0019263449134104764, 17: 0.003989241266729961, 18: 0.0038099116708378276, 19: 0.0028540761466497432}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0024716212918543517, 1: -0.0002718868320654481, 2: -0.0018885320967696108, 3: 0.00031634416341026436, 4: -0.0038010438424638674, 5: -0.005179616579544129, 6: -0.009230104126668992, 7: 0.0013278167540848695, 8: -0.0034442276952350403, 9: -0.0019323203269559293, 10: -0.0028165608406790213, 11: 0.002612092579299126, 12: -0.006131718031227097, 13: 0.001571193457675092, 14: 0.0017301363579549259, 15: 0.0006777853192830056, 16: -0.0017329625747755932, 17: -0.002386361330340108, 18: -0.0002901348409476246, 19: 0.003054831084250066}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.021411746216045555, 1: 0.00020820507656081668, 2: 0.00250905849837965, 3: 0.018665248055419192, 4: 0.057252402140594065, 5: 0.0362246916336438, 6: 0.062479772432900524, 7: -0.03303009417664179, 8: 0.005362321031678529, 9: 0.002579035280303954, 10: 0.008965396440705799, 11: -0.026017186253248396, 12: -0.0008460186239778094, 13: -0.0159831434412952, 14: -0.00008387874273071263, 15: -0.0591144664189781, 16: 0.015145589160833226, 17: 0.003813737282220789, 18: -0.005446240519590068, 19: 0.007080603256132106}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.01566526606911011, 1: 0.0029104801370168614, 2: 0.004644028142345338, 3: 0.018280735922243167, 4: 0.04828150985355421, 5: 0.02655107357422824, 6: 0.05329020014455206, 7: -0.022809503530544565, 8: 0.0005638938421957988, 9: 0.0010740552991861355, 10: 0.009200480590756246, 11: -0.019572798776645958, 12: -0.009930093143249401, 13: -0.018225237958981948, 14: 0.0030746542720368718, 15: -0.05046015711306654, 16: 0.01118106766184641, 17: -0.001447918258236991, 18: 0.0030494717135832114, 19: -0.0004349772189687706}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0007242827272006834, 1: -0.006458078109534201, 2: -0.002923269906177697, 3: -0.006745939830604721, 4: -0.001788082803887876, 5: 0.004535520437207181, 6: 0.006929743172675411, 7: -0.0053829444805453455, 8: -0.008078450360606303, 9: -0.004841173649283983, 10: 0.0026545144282532733, 11: -0.008249611736016424, 12: -0.000244439576519621, 13: 0.0001714583652833881, 14: -0.005059662661898218, 15: -0.003506641432530088, 16: -0.003339444545372211, 17: -0.002172866704540768, 18: -0.0077194307215015965, 19: -0.007778423059821591}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.03890587378134067, 1: -0.000023818929879776066, 2: -0.002138060850774685, 3: -0.023023608692932313, 4: -0.08254000734878827, 5: -0.04911677137387437, 6: -0.08784035938594953, 7: 0.05025337323052036, 8: 0.0008590659356921944, 9: 0.00476342921218976, 10: -0.010415070423451979, 11: 0.049798069184384806, 12: 0.008517110296240684, 13: 0.03367971068286161, 14: 0.004059153472235914, 15: 0.09252630017159644, 16: -0.009295293655059168, 17: -0.0012697818319961861, 18: 0.004379998787343906, 19: -0.0029951551633622744}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.0013295642049715242, 1: -0.0044630832386817025, 2: -0.0019173518216722492, 3: 0.0011032977901988313, 4: -0.0049282962137937696, 5: -0.001697241999602016, 6: -0.007598320387314912, 7: 0.006482708605550676, 8: 0.0006286540257144576, 9: -0.005005441769980745, 10: -0.0032125750119701914, 11: -0.0007569035928822914, 12: 0.0009060562538957505, 13: 0.0017383293619676807, 14: -0.0016814740811139308, 15: 0.0052186438774498335, 16: -0.0004401502230219823, 17: -0.004608428332692936, 18: 0.00030846388786640115, 19: -0.0005097879809064348}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.02860373152768895, 1: 0.0637761953623103, 2: -0.07568266735802501, 3: 0.020916393232393957, 4: -0.1341335205923223, 5: -0.03311126686461306, 6: -0.18966772260896572, 7: 0.15235224755184248, 8: -0.09376298136338983, 9: -0.09128048319360327, 10: -0.07153493672960642, 11: 0.029917301502843992, 12: 0.12904471847541774, 13: 0.03446063976647389, 14: -0.09511485864495824, 15: 0.1546277573487238, 16: -0.07004577809203684, 17: 0.08357214419129107, 18: 0.11820923682033058, 19: 0.09963405058244568}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.01697547622569717, 1: 0.021106674573483624, 2: 0.03479243721517558, 3: 0.0042863922560843455, 4: 0.010993883803460005, 5: 0.11499105358464966, 6: 0.17196334969617202, 7: -0.039704771969813035, 8: -0.02027192088826061, 9: -0.011506498236344457, 10: 0.04346569900073713, 11: -0.11575158676686075, 12: -0.018820627412317742, 13: -0.005597220519975535, 14: 0.00902709540043908, 15: -0.047705314460303745, 16: 0.05400892569691416, 17: 0.008977550836547166, 18: 0.009304127356419382, 19: 0.0042524548607885074}}, {sx: 1, sy: 1, depth: 20, w: {0: 0.0483413753607365, 1: 0.001895054905295526, 2: -0.013580156155698955, 3: -0.03723950834833343, 4: -0.11745998287981643, 5: -0.060672708885396574, 6: -0.12612008143578296, 7: 0.08015071245751632, 8: 0.008600211511725313, 9: 0.003392498121550219, 10: -0.00656877018594326, 11: 0.06836513363665041, 12: 0.01206851525436358, 13: 0.04695876577377098, 14: 0.0047813073043308715, 15: 0.12412044382747707, 16: -0.014263405773403069, 17: -0.0040681147052198195, 18: 0.005575470673034754, 19: -0.0018182791187446473}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.025521821709812816, 1: 0.0053345547490874865, 2: -0.027646537234264253, 3: 0.08989543058202511, 4: 0.13956012138826168, 5: 0.10207312019260271, 6: 0.030091859289307785, 7: -0.024423096810335967, 8: -0.008241660604813612, 9: -0.010782762485385507, 10: -0.027030293061207484, 11: -0.01907130021389981, 12: 0.05000386119084678, 13: -0.033011794736189475, 14: -0.025928773751607036, 15: -0.13283548861511973, 16: -0.02882189361388194, 17: 0.03296294105282509, 18: 0.04336682935679404, 19: 0.033575801487160085}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.020280799578224734, 1: -0.000494560000723088, 2: 0.008640341595013808, 3: -0.014922575768467927, 4: -0.016481397236912217, 5: -0.022197783734274605, 6: 0.0366492987628483, 7: -0.03282927462792145, 8: -0.010361260836439458, 9: -0.012121001921771608, 10: 0.008002280879423545, 11: -0.018833304017302727, 12: -0.022645366648677615, 13: -0.01637951948328484, 14: 0.00018108613638781533, 15: 0.007540493935787004, 16: 0.013844016051355957, 17: -0.011981216870001405, 18: -0.015338002337270019, 19: -0.008534935821803468}}, {sx: 1, sy: 1, depth: 20, w: {0: -0.0017260572137779789, 1: -0.006423486041407817, 2: -0.0032793594685668714, 3: -0.003937623780266815, 4: -0.006654193304715065, 5: 0.0003278267489555869, 6: -0.0011374098515739377, 7: -0.006963009985909811, 8: -0.007216249109457717, 9: -0.003924344694908799, 10: -0.0048900579210200195, 11: -0.009826565187037894, 12: -0.0039764725008588735, 13: -0.008001944587628781, 14: -0.005013252934927847, 15: -0.01158127066981915, 16: -0.006023918868956319, 17: 0.0006437031142922342, 18: 0.0002814645881725623, 19: -0.005828788173836032}}], biases: {sx: 1, sy: 1, depth: 30, w: {0: 0.03858354454008072, 1: 0.052665041136399325, 2: 0.41616556508851693, 3: 0.03335874673316635, 4: 0.08761307551798629, 5: 0.08207160877977929, 6: 0.02642234227926816, 7: 0.08584493022372863, 8: 0.0879299965927531, 9: 0.3810581399641685, 10: 0.048136537422580214, 11: 0.039530029473496826, 12: 0.06556537380580162, 13: 0.06996797943828927, 14: -0.0032365147348685486, 15: 0.09850807758708625, 16: 0.09207248329383261, 17: 0.08353723130664119, 18: 0.08287389185676097, 19: 0.12717138382057946, 20: 0.09365544983568765, 21: 0.05139441599501611, 22: 0.03581028330256079, 23: 0.09790220749087811, 24: 0.07968550242311545, 25: 0.07623456022553148, 26: 0.06292979979831256, 27: 0.17290295191889624, 28: 0.05619741406394539, 29: 0.05082773066518397}}}, {out_depth: 30, out_sx: 1, out_sy: 1, layer_type: 'relu'}, {out_depth: 20, out_sx: 1, out_sy: 1, layer_type: 'fc', num_inputs: 30, l1_decay_mul: 0, l2_decay_mul: 1, filters: [{sx: 1, sy: 1, depth: 30, w: {0: 0.1956001446801485, 1: 0.0030444878051817015, 2: -0.34753604489470963, 3: 0.002352097798129329, 4: -0.03321125273086751, 5: -0.004035358323454276, 6: 0.1314647885573559, 7: -0.027635075942738962, 8: 0.08577036238072075, 9: -0.4250616151847519, 10: 0.00497557766295749, 11: 0.005812890274457859, 12: -0.00430455878254222, 13: 0.09169764109209871, 14: 0.29934963440590107, 15: 0.0030283918381956644, 16: 0.09845152199642158, 17: -0.02362345632925427, 18: 0.0020221858608334324, 19: -0.06523294736207771, 20: -0.05142486546718246, 21: -0.0017693929263521463, 22: 0.10132854800327191, 23: 0.004880064594969198, 24: 0.23980470495417375, 25: -0.1360017382754948, 26: 0.13898507615619232, 27: -0.13568098104806978, 28: -0.0383832906034142, 29: 0.0013962196274092556}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.11910852807655715, 1: -0.0003662355005411867, 2: 0.21639603916142944, 3: 0.0009490366599735197, 4: 0.0171234727984679, 5: 0.002625607181749888, 6: -0.08060083979614961, 7: 0.014627883966724636, 8: -0.0483574276553312, 9: 0.2650058171310647, 10: -0.0014944575153006045, 11: -0.0033594471820838044, 12: 0.003110898590144223, 13: -0.05673190541450669, 14: -0.18514321031938713, 15: -0.0014084004278713763, 16: -0.06077800223330697, 17: 0.014098628830763139, 18: -0.004628765141972832, 19: 0.040365336591739964, 20: 0.03210733617412901, 21: 0.002943060783708843, 22: -0.061656914050243476, 23: -0.005403543290894023, 24: -0.1441291087157945, 25: 0.08973588032996783, 26: -0.0846432611176759, 27: 0.08621422858748314, 28: 0.019410711365533018, 29: -0.0013788631249089182}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.10463578742239645, 1: -0.0029091301418131374, 2: 0.19087364547050717, 3: -0.0021569977182505397, 4: 0.017195109960061326, 5: -0.0019239208076846188, 6: -0.07053358262612974, 7: 0.011615040501181804, 8: -0.04310301123854774, 9: 0.23697878623207477, 10: -0.0024223072426718486, 11: -0.0019350453466763682, 12: 0.002659043978161333, 13: -0.05043097765714813, 14: -0.1594671122956537, 15: 0.002149488828830032, 16: -0.04889322341727123, 17: 0.014976842933949942, 18: -0.003836054173678279, 19: 0.034720603670052246, 20: 0.03419414113463101, 21: 0.007351344724331264, 22: -0.0523491235010737, 23: -0.005203660135897134, 24: -0.1289468700338681, 25: 0.07487843968356221, 26: -0.07841035789798487, 27: 0.07488061355186351, 28: 0.020218427643131708, 29: -0.0006107055992579596}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.13324222729508084, 1: 0.0033415208750528762, 2: -0.248255543934685, 3: 0.0004194071070511588, 4: -0.024430403362378433, 5: -0.00024868517807632626, 6: 0.09108623099372187, 7: -0.021887047152270675, 8: 0.06248456313521478, 9: -0.30579105661992, 10: -0.0001010758480634431, 11: 0.004083291330743377, 12: 0.0003360695909860299, 13: 0.0613776294058548, 14: 0.20839401526478363, 15: 0.0015498811871563268, 16: 0.06997886794984184, 17: -0.017714962054633507, 18: 0.001894303530183338, 19: -0.04837204848749286, 20: -0.03749737249734357, 21: -0.003702284912227229, 22: 0.07068113819414686, 23: 0.006157283059854127, 24: 0.17001675639004526, 25: -0.0971938925463162, 26: 0.09674422702110644, 27: -0.10171364927868078, 28: -0.026652904009066676, 29: 0.005014310757964591}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.05137191589814732, 1: -0.0018054276096302537, 2: -0.09841720502533041, 3: -0.0005552996296124259, 4: -0.012057968329266769, 5: -0.0010238872609618062, 6: 0.030606673002570577, 7: -0.004553327811585807, 8: 0.022163165452798877, 9: -0.11708236131438775, 10: 0.0031296372978270727, 11: 0.00024533299160682136, 12: -0.0014636733830770323, 13: 0.024506768262379557, 14: 0.08093877680656159, 15: -0.002794593126368706, 16: 0.025623937905878753, 17: -0.0033202301809064695, 18: 0.0012389730058555636, 19: -0.019706417084781727, 20: -0.01852574148366979, 21: 0.0016106422091867543, 22: 0.02022275448064228, 23: 0.0042846597540041565, 24: 0.06276183123134618, 25: -0.037967598955485564, 26: 0.03447475857846917, 27: -0.03862149717808446, 28: -0.008807968458590752, 29: -0.000004300013132069142}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.050475993728621216, 1: -0.0011258682289138784, 2: -0.08946599223011022, 3: 0.003414962038439212, 4: -0.012790310142036111, 5: 0.0007170904952939157, 6: 0.03423600917382886, 7: -0.010207825453864014, 8: 0.017747070671030353, 9: -0.1071498817170489, 10: -0.002940308256174861, 11: 0.0029484703559432184, 12: 0.0005167941583327852, 13: 0.024333982225153282, 14: 0.06770485587584228, 15: -0.0014461822178340438, 16: 0.021263392272608022, 17: -0.007510643819517309, 18: 0.0011651777865658304, 19: -0.010947642626033309, 20: -0.014412293291206328, 21: -0.0024405003219694294, 22: 0.027494346773774787, 23: 0.0020500839130713562, 24: 0.05314362078096242, 25: -0.02901581361350127, 26: 0.034781434820695074, 27: -0.03556766408005052, 28: -0.01354032294878347, 29: 0.0030140694535553854}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.0530179950163406, 1: 0.0015151190315992487, 2: -0.10072071391888375, 3: 0.001173172927463371, 4: -0.012514866093286708, 5: -0.004247313756212202, 6: 0.03689856773929751, 7: -0.008055876498608092, 8: 0.024275236631748215, 9: -0.12142164209549683, 10: 0.0014509998006506982, 11: -0.0003466698885295361, 12: 0.002857321563248372, 13: 0.025427884167699907, 14: 0.08319841780654902, 15: -0.00159072831214193, 16: 0.028536255518187316, 17: -0.0091459019741742, 18: 0.002289861941884017, 19: -0.021748229603821334, 20: -0.016677537958189447, 21: 0.0016907818195130678, 22: 0.028480862975407542, 23: -0.0006901480377808223, 24: 0.0684727003530146, 25: -0.03883526258600912, 26: 0.03647388365101665, 27: -0.04152598490787015, 28: -0.012610431706874606, 29: 0.001880863133237686}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.063923385238037, 1: -0.0012069353552571934, 2: -0.1243893144437374, 3: -0.0010299997529861357, 4: -0.01481224730170803, 5: 0.0018442005580234886, 6: 0.04560832138595546, 7: -0.009474150418732235, 8: 0.026566815843428748, 9: -0.1475787904026828, 10: 0.0017122022898600007, 11: 0.001866547057767934, 12: -0.0002306311825944075, 13: 0.03075150754830455, 14: 0.09753923993339818, 15: -0.0004489630861824742, 16: 0.03571656515834617, 17: -0.007766558112293992, 18: 0.004929293461056867, 19: -0.025401551992998105, 20: -0.0172641516405072, 21: -0.006198324096594477, 22: 0.0332634256848482, 23: 0.0008575929017009991, 24: 0.08001639283952004, 25: -0.04644129195414254, 26: 0.04868946504244285, 27: -0.05359623728541978, 28: -0.016037166104165758, 29: -0.00044170302832126005}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.03940622262456358, 1: -0.004161689466769617, 2: 0.0776524789846982, 3: -0.0027107033004841437, 4: 0.00771990005587393, 5: 0.0007498309648146922, 6: -0.0296731868027447, 7: 0.006252381782152804, 8: -0.01790038866632302, 9: 0.09158189708353304, 10: -0.0014320655240537866, 11: -0.003448629966756224, 12: 0.0028071032043230004, 13: -0.01960899757680033, 14: -0.06686985575690053, 15: 0.0014987338866394597, 16: -0.023635119289918058, 17: 0.006553488101489417, 18: -0.00113737440286561, 19: 0.014831890109485161, 20: 0.010305796028538441, 21: 0.0015888354210656728, 22: -0.02226850583317267, 23: -0.0016993030246115735, 24: -0.05338703369078155, 25: 0.032263297398785494, 26: -0.027187830473575796, 27: 0.032693211827145525, 28: 0.012230247723724937, 29: -0.000287979610779647}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.014697598734671706, 1: -0.0022465431179553466, 2: -0.027696243030099394, 3: -0.0012135443466245485, 4: -0.002699778618290362, 5: 0.00005052328946763391, 6: 0.0079688500000349, 7: -0.003830479828243108, 8: 0.008460529736981814, 9: -0.03607542807653355, 10: 0.00034306638684063743, 11: 0.004921168426685858, 12: 0.0013227134569530165, 13: 0.009276264653737319, 14: 0.023150645779674458, 15: 0.00031032621196522736, 16: 0.0078095704146581395, 17: -0.0047090328633345255, 18: 0.002632450013331916, 19: -0.003322142761627639, 20: -0.0004554327000850305, 21: 0.002828875474644073, 22: 0.004678837166884196, 23: 0.008675581312651944, 24: 0.02014696605907324, 25: -0.015175800625372793, 26: 0.010853142338301485, 27: -0.010522457320962608, 28: -0.003713531381879904, 29: -0.0005092284205449235}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.04662808446303439, 1: -0.00046407899862123137, 2: 0.0858937135208694, 3: -0.002344457643597299, 4: 0.008235103479343314, 5: -0.003684608703721026, 6: -0.029927912956609425, 7: 0.003054356540270239, 8: -0.02156499871003817, 9: 0.10129749526324529, 10: -0.0010474669863394235, 11: 0.000195180225403032, 12: 0.0012632453073562811, 13: -0.01869890625311097, 14: -0.07061592415662955, 15: -0.0028210141636349152, 16: -0.022471637780608372, 17: 0.0027830443253582266, 18: -0.001935041621177554, 19: 0.018851757818644233, 20: 0.015594466729815123, 21: 0.001072909247017117, 22: -0.019737396350245753, 23: -0.002475252183213457, 24: -0.0580992751267761, 25: 0.0354497478397625, 26: -0.030631087864342613, 27: 0.04032607186668685, 28: 0.00940857330140074, 29: -0.001771113286857199}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.0568248210879738, 1: 0.0014942811666065034, 2: 0.11034287825830595, 3: -0.0006119713833846914, 4: 0.007810080375320613, 5: -0.001526824902575891, 6: -0.04102971304483158, 7: 0.008467854255975965, 8: -0.02855503410576324, 9: 0.14133232214541336, 10: -0.002865877015707583, 11: 0.002711909711987976, 12: -0.002018162488133463, 13: -0.029256538449978053, 14: -0.08948285816237696, 15: -0.0007636093602461134, 16: -0.03229084517301406, 17: 0.007455021898811894, 18: -0.001363419632590249, 19: 0.01584991443592498, 20: 0.022223270978648013, 21: 0.002216881184003755, 22: -0.026855159503835845, 23: 0.0018109761432105933, 24: -0.07167242986748726, 25: 0.04642842526855523, 26: -0.040673018252259635, 27: 0.044601972967434615, 28: 0.012841095438424968, 29: 0.0015387145735876488}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.08548815564819111, 1: 0.001029744070231558, 2: 0.15752052880459982, 3: 0.00023418528479718283, 4: 0.017079304778133266, 5: 0.002092447186676032, 6: -0.05884810865597995, 7: 0.012130558817886288, 8: -0.03575879975755796, 9: 0.18977362734994058, 10: -0.002559031413565136, 11: 0.0018086247106070272, 12: 0.0013128392959259267, 13: -0.039757733857321176, 14: -0.12787300764762358, 15: 0.0002778489921905575, 16: -0.04165840355186983, 17: 0.01355488612385641, 18: -0.0053690010908551715, 19: 0.029369975305606488, 20: 0.021502529938843273, 21: 0.002184076345372764, 22: -0.038313574012280124, 23: -0.002676424491477872, 24: -0.10160897781379, 25: 0.06005875967525804, 26: -0.0585959425665581, 27: 0.07081194229946562, 28: 0.016404119112327073, 29: -0.00017843712112027314}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.0762005401203631, 1: 0.0015180130436173423, 2: -0.14210219904718696, 3: -0.0006578702563383408, 4: -0.014177664861053273, 5: 0.00029135126624208667, 6: 0.051169573528635055, 7: -0.009990443254414262, 8: 0.03674141532610836, 9: -0.17109805769035863, 10: 0.00286069387550557, 11: 0.002833006827646988, 12: -0.0006155513404215787, 13: 0.03463852097605439, 14: 0.11980060213087212, 15: -0.001432501557550072, 16: 0.03719956634559452, 17: -0.0120465621229221, 18: -0.0022674477942492477, 19: -0.024537055529581943, 20: -0.025408126519062112, 21: -0.003570188267121196, 22: 0.038887433818124546, 23: 0.0014633961512720947, 24: 0.0945911553055516, 25: -0.05704865423117534, 26: 0.053515211256958704, 27: -0.05775326651563879, 28: -0.011002350721996972, 29: 0.003704330445080199}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.010919885670627663, 1: -0.0039282125549959055, 2: -0.023229675141832076, 3: -0.0027214725725355866, 4: -0.001030751706268969, 5: -0.0024159898432613426, 6: 0.007063554238546404, 7: -0.002688345369253158, 8: 0.0053339533174454855, 9: -0.03222646525169745, 10: -0.0003452131594137766, 11: -0.0011549506604668692, 12: -0.002675231582305183, 13: 0.0024163429004249257, 14: 0.020342077583634644, 15: 0.0031095048715532644, 16: 0.0059618363605965265, 17: -0.0034668903396601752, 18: 0.0027324456319968993, 19: -0.0059063198143048746, 20: -0.003163422196062415, 21: 0.0003925518279547949, 22: 0.006258552977118276, 23: 0.0007101340420452826, 24: 0.017094675684152922, 25: -0.014339937726058858, 26: 0.007952157895706165, 27: -0.007635672153974811, 28: -0.004333587597581662, 29: -0.0014030618265024933}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.04867687957341833, 1: 0.0005359618912729969, 2: 0.08675815075845586, 3: -0.003122059530251471, 4: 0.009011063189178898, 5: 0.0008520141862620851, 6: -0.02923333222472839, 7: 0.004733850390517171, 8: -0.01867318363268719, 9: 0.10711914523704434, 10: -0.0006114500530571999, 11: -0.00311567140934224, 12: -0.0018811564436809556, 13: -0.022567194022989682, 14: -0.07216887922368105, 15: -0.003103258113611835, 16: -0.02186305767412021, 17: 0.008880859122527096, 18: -0.0016809623458550254, 19: 0.015378327824040652, 20: 0.011926251945635647, 21: 0.0026934819451182768, 22: -0.0232257777681155, 23: -0.0038135484967682406, 24: -0.05428047646060177, 25: 0.03119799490171324, 26: -0.03204505909304749, 27: 0.03239132071950772, 28: 0.009556790325969039, 29: 0.004232724441847768}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.08223157257323235, 1: -0.0015948423897331836, 2: 0.15306193255806796, 3: 0.0030111669373819117, 4: 0.016008162211743584, 5: 0.0022511976231319396, 6: -0.05550102440034574, 7: 0.009262177036333918, 8: -0.03733168536506953, 9: 0.1895165183667166, 10: -0.0017370756298413007, 11: 0.0028108468825496407, 12: -0.004105315411087498, 13: -0.041935116490480664, 14: -0.13024249527597698, 15: 0.000035700452905071764, 16: -0.04035943630108062, 17: 0.010888733091405693, 18: -0.0022290710036708392, 19: 0.029315265604951596, 20: 0.023416867577149475, 21: 0.0009715170949012686, 22: -0.043447245827433395, 23: 0.00003284904693510647, 24: -0.10142275201883935, 25: 0.06020942115267141, 26: -0.05559776668319836, 27: 0.05760688968457623, 28: 0.013040900999501245, 29: -0.002172008854578447}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.03799312087810695, 1: 0.002399169712892036, 2: 0.06562546341519607, 3: 0.0006358609548990276, 4: 0.006186741089776494, 5: 0.0007561491664792683, 6: -0.026377470185670635, 7: 0.0015873055245310818, 8: -0.0161911134052134, 9: 0.08515842527272145, 10: -0.000988687217453335, 11: -0.0039456907556329485, 12: -0.0009729337852085892, 13: -0.012499592223695113, 14: -0.05193098303592626, 15: 0.0022770218851393253, 16: -0.022582031532986394, 17: 0.003440181389833197, 18: -0.0015630966017320279, 19: 0.012055861382131475, 20: 0.008026987039861837, 21: 0.003335589603689411, 22: -0.021776031073829423, 23: -0.0002910987227503648, 24: -0.042577871587058023, 25: 0.026956837960726697, 26: -0.028074106585770222, 27: 0.022502998476975938, 28: 0.008760677379711439, 29: 0.0013033373737713482}}, {sx: 1, sy: 1, depth: 30, w: {0: 0.08160022854199615, 1: 0.0007823895528931336, 2: -0.14597146632156272, 3: 0.0006958920304647918, 4: -0.015986506547375552, 5: -0.0030916654133331663, 6: 0.052773701542163286, 7: -0.013978755337040943, 8: 0.0351609325127203, 9: -0.17900947274965845, 10: 0.0022434392583458823, 11: -0.0008637537922830618, 12: -0.00008851161214558816, 13: 0.03549111227415684, 14: 0.12348102863626764, 15: 0.00307265849501941, 16: 0.0397944671634305, 17: -0.009328877520854905, 18: 0.001725335104617548, 19: -0.025484570992771773, 20: -0.02347401761001896, 21: -0.0002703090189531128, 22: 0.03884818209845624, 23: 0.003936741223583758, 24: 0.09708584806402407, 25: -0.0566265001098901, 26: 0.05657048298378323, 27: -0.059105463846416614, 28: -0.015872162946813, 29: 0.0004619877206380022}}, {sx: 1, sy: 1, depth: 30, w: {0: -0.03809451505626212, 1: 0.0028184132089356614, 2: 0.06768884017107957, 3: -0.00040368772554889734, 4: 0.004424920861746452, 5: -0.0012390298534140237, 6: -0.025258514866266485, 7: 0.009469526060565156, 8: -0.01681910310170468, 9: 0.0838219983698004, 10: -0.0018936841427307886, 11: -0.00009916045123434236, 12: 0.002266576182735079, 13: -0.02047801811949432, 14: -0.0567039024530524, 15: 0.00038887877855153395, 16: -0.018766559070298717, 17: 0.0033255962491446013, 18: -0.001545393322162879, 19: 0.012293855340729817, 20: 0.011212487213406239, 21: -0.0015660165031063655, 22: -0.016113450068813852, 23: -0.001948966879207249, 24: -0.04553687335520767, 25: 0.02551871416223186, 26: -0.028521508065769748, 27: 0.027513922409092388, 28: 0.007321408528453401, 29: 0.0010505896352309232}}], biases: {sx: 1, sy: 1, depth: 20, w: {0: -0.1106867371054687, 1: 0.060321191505676275, 2: 0.021067071951982576, 3: -0.049423232172188164, 4: 0.0017837477359822105, 5: 0.0011852266137575489, 6: 0.00578863436396338, 7: 0.005619233609042388, 8: -0.0011400825403515824, 9: 0.0023502458302385987, 10: -0.014012502621641646, 11: -0.00868918623833425, 12: -0.0035750066647599844, 13: -0.00918643614902899, 14: 0.0011660651071480328, 15: -0.0019062735008518183, 16: 0.012105432630335054, 17: 0.0010923874300726385, 18: -0.01809067936588007, 19: -0.0006770883374323713}}}, {out_depth: 20, out_sx: 1, out_sy: 1, layer_type: 'sigmoid'}, {out_depth: 1, out_sx: 1, out_sy: 1, layer_type: 'fc', num_inputs: 20, l1_decay_mul: 0, l2_decay_mul: 1, filters: [{sx: 1, sy: 1, depth: 20, w: {0: 0.7869484885880814, 1: -0.4794391931237563, 2: -0.422666534978188, 3: 0.5584584051190936, 4: 0.21476648255695904, 5: 0.19507244083723718, 6: 0.22555645135516336, 7: 0.27254783978609354, 8: -0.1679105786068546, 9: 0.06664099659406174, 10: -0.18442019828495482, 11: -0.24246094625705367, 12: -0.34127692794977393, 13: 0.3166252545040886, 14: 0.057345668986085424, 15: -0.18609470646029613, 16: -0.33618563218178926, 17: -0.14435721779418775, 18: 0.32773121306365804, 19: -0.14794260730753556}}], biases: {sx: 1, sy: 1, depth: 1, w: {0: 0.1863244832072473}}}, {out_depth: 1, out_sx: 1, out_sy: 1, layer_type: 'regression', num_inputs: 1}]};
    }

    private init(opts) {
        if (!opts) { opts = {}; }

        if (opts.log) { this.log = opts.log; }


        this.net = new convnetjs.Net();
        this.net.fromJSON(this.getNetConfig());

        // train on this datapoint, saying [0.5, -1.3] should map to value 0.7:
        // note that in this case we are passing it a list, because in general
        // we may want to  regress multiple outputs and in this special case we
        // used num_neurons:1 for the regression to only regress one.
        this.trainer = new convnetjs.SGDTrainer(this.net,
                    {learning_rate: 0.01, momentum: 0.001, batch_size: 10, l2_decay: 0.001});

        this.targets = [
            [0], [1], [2], [3], [4], [5], [6],
        ];

        this.targetRanges = [
            [0, .15], [.15, .25], [.25, .35], [.35, .45], [.45, .55], [.55, .65], [.65, 1],
        ];

    }
}
